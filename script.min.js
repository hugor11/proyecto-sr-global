function startApp(){if(!window.__appStarted){window.__appStarted=!0,initFancybox(),initMobileMenu(),addScrollEffects(),initModals(),watchCarouselVisibility();try{initSwiper()}catch{}initZohoFormIntegration(),initGAInteractions()}}function safeStartApp(){if("complete"!==document.readyState&&"interactive"!==document.readyState)return console.log("DOM not ready, waiting..."),!1;if("function"!=typeof document.querySelector)return console.warn("Basic DOM methods not available"),!1;try{return startApp(),!0}catch(e){return console.error("Error starting app:",e),setTimeout(function(){try{startApp()}catch(e){console.error("Second attempt failed:",e)}},1e3),!1}}!function(){"use strict";function e(){try{const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`),console.log("VH updated:",e,"px")}catch(e){console.warn("Error setting VH property:",e)}}Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches&&t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector),e(),window.addEventListener("resize",e,{passive:!0}),window.addEventListener("orientationchange",function(){setTimeout(e,100)},{passive:!0}),"ontouchstart"in window&&document.documentElement.classList.add("touch-device"),window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)&&(document.documentElement.style.webkitOverflowScrolling="touch"),window.debugMenuPosition=function(){const e=document.querySelector("#menu-toggle");if(!e)return console.error("Menu toggle not found");const t=e.getBoundingClientRect(),o=t.left+t.width/2,n=t.top+t.height/2,i=document.elementFromPoint(o,n);console.log("=== DIAGNÓSTICO MENÚ ==="),console.log("Botón:",e),console.log("Rectángulo:",t),console.log("Centro del botón:",{x:o,y:n}),console.log("Elemento superior:",i),console.log("¿Es el botón?",i===e),console.log("Z-index del botón:",getComputedStyle(e).zIndex),console.log("Z-index del elemento superior:",i?getComputedStyle(i).zIndex:"N/A"),i!==e&&(console.warn("⚠️ PROBLEMA: Hay algo tapando el botón del menú"),console.log("Elemento que tapa:",i),console.log("Clases del elemento:",i?.className))},console.log("iOS/Safari polyfills and fixes loaded")}(),window.__appStarted=window.__appStarted||!1,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){setVH(),initMobileMenu()},{once:!0}):setTimeout(function(){setVH(),initMobileMenu()},0),window.addEventListener("load",function(){menuInitDone||setTimeout(function(){setVH(),initMobileMenu()},200)},{once:!0}),window.addEventListener("pageshow",function(e){console.log("pageshow event fired, persisted:",e.persisted),e.persisted?(console.log("Page restored from bfcache, reinitializing mobile menu"),setTimeout(function(){setVH(),initMobileMenu(!0),document.querySelectorAll(".overlay, .hero::before, .banner-overlay").forEach(e=>{const t=getComputedStyle(e);"0"!==t.opacity&&"hidden"!==t.visibility||(e.style.pointerEvents="none")})},100)):menuInitDone||setTimeout(function(){setVH(),initMobileMenu()},100)}),setTimeout(function(){menuInitDone||(console.warn("Forcing app start after timeout"),setVH(),initMobileMenu(!0))},3e3);let promotionsSwiper=null;function initSwiper(){ensurePromotionsSwiper(!1)}let __swiperWaitTimer=null;function ensurePromotionsSwiper(e=!1){const t=document.querySelector("#promotions-carousel");if(void 0===window.Swiper)return void(__swiperWaitTimer||(__swiperWaitTimer=setInterval(()=>{void 0!==window.Swiper&&(clearInterval(__swiperWaitTimer),__swiperWaitTimer=null,ensurePromotionsSwiper(!0))},150)));if(!t)return;const o=!(!t.offsetParent&&!t.getClientRects().length);if(promotionsSwiper)try{promotionsSwiper.update(),console.log("🔄 Swiper actualizado")}catch{}else{if(!o&&!e)return;try{promotionsSwiper=new Swiper("#promotions-carousel",{slidesPerView:1,spaceBetween:20,pagination:{el:"#promotions-carousel .swiper-pagination",clickable:!0},navigation:{nextEl:"#promotions-carousel .swiper-button-next",prevEl:"#promotions-carousel .swiper-button-prev"},breakpoints:{640:{slidesPerView:2,spaceBetween:20},1024:{slidesPerView:3,spaceBetween:30}},loop:!0,autoplay:{delay:5e3,disableOnInteraction:!1},observer:!0,observeParents:!0}),setTimeout(()=>promotionsSwiper&&promotionsSwiper.update(),100),console.log("✅ Swiper inicializado")}catch(e){console.error("❌ Error al inicializar Swiper:",e)}}}function watchCarouselVisibility(){const e=document.querySelector("#promotions-carousel");if(!("IntersectionObserver"in window)||!e)return;const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(ensurePromotionsSwiper(!0),t.disconnect())})},{threshold:.1});t.observe(e)}function initFancybox(){if(void 0!==window.Fancybox)try{Fancybox.bind("[data-fancybox]",{animated:!0,showClass:"fancybox-zoomIn",hideClass:"fancybox-zoomOut"})}catch{}}function initZohoFormIntegration(){const e=document.getElementById("zoho-form-iframe");if(!e)return;let t=1e3;window.addEventListener("message",o=>{const n=o.data;if(n&&"object"==typeof n&&("zohoForm:resize"===n.type&&n.height&&(o=>{const n=Math.max(600,Math.min(3e3,Number(o)||t));t=n,e.style.height=n+"px"})(n.height),"zohoForm:submitted"===n.type))try{"function"==typeof gtag&&gtag("event","generate_lead",{method:"zoho_form",event_category:"lead",event_label:"contact_form",value:1})}catch{}});const o=setInterval(()=>{try{e.contentWindow&&e.contentWindow.postMessage({type:"parent:requestHeight"},"*")}catch{}},1500),n=new MutationObserver(()=>{document.body.contains(e)||(clearInterval(o),n.disconnect())});n.observe(document.body,{childList:!0,subtree:!0})}function initGAInteractions(){const e=(e,t)=>{try{"function"==typeof gtag&&gtag("event",e,t||{})}catch{}};document.addEventListener("click",t=>{const o=t.target&&t.target.closest?t.target.closest("a"):null;if(!o)return;const n=(o.getAttribute("href")||"").trim();if(!n)return;const i={page_path:location.pathname+location.search,link_url:n};if(/wa\.me|api\.whatsapp\.com|whatsapp:\/\//i.test(n))return void e("contact",{method:"whatsapp",...i});if(n.startsWith("mailto:"))return void e("contact",{method:"email",...i});if(n.startsWith("tel:"))return void e("contact",{method:"phone",...i});const r=o.matches('[data-lang-key="navContactBtn"]'),s=/contact\.html(\?|#|$)/i.test(n);(r||s)&&e("contact",{method:r?"contact_button":"contact_page_link",...i})},!0)}function addScrollEffects(){window.addEventListener("scroll",function(){const e=document.getElementById("navbar");window.scrollY>50?(e.classList.add("py-2"),e.classList.remove("py-3")):(e.classList.add("py-3"),e.classList.remove("py-2"))});const e=document.querySelectorAll(".destination-circle, .service-card"),t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.style.opacity="1",e.target.style.transform="translateY(0)",t.unobserve(e.target))})},{threshold:.1});e.forEach(e=>{e.style.opacity="0",e.style.transform="translateY(20px)",e.style.transition="opacity 0.5s ease, transform 0.5s ease",t.observe(e)})}function initModals(){document.querySelectorAll(".open-modal").forEach(e=>{e.addEventListener("click",function(){const e=this.getAttribute("data-modal");document.getElementById(e).classList.remove("hidden"),document.body.style.overflow="hidden"})}),document.querySelectorAll(".modal-close").forEach(e=>{e.addEventListener("click",function(){this.closest('[id$="-modal"]').classList.add("hidden"),document.body.style.overflow=""})}),document.querySelectorAll('[id$="-modal"]').forEach(e=>{e.addEventListener("click",function(e){e.target===this&&(this.classList.add("hidden"),document.body.style.overflow="")})}),document.addEventListener("keydown",function(e){"Escape"===e.key&&document.querySelectorAll('[id$="-modal"]').forEach(e=>{e.classList.contains("hidden")||(e.classList.add("hidden"),document.body.style.overflow="")})})}let menuInitDone=!1;function initMobileMenu(e=!1){if(menuInitDone&&!e)return;const t=document.querySelector("#menu-toggle"),o=document.querySelector("#mobile-menu");if(!t||!o)return void console.warn("Mobile menu elements not found");console.log("Initializing mobile menu (iOS professional version)"),console.log("Menu toggle element:",t),console.log("Menu toggle z-index:",window.getComputedStyle(t).zIndex),console.log("User agent:",navigator.userAgent),console.log("Is iOS device:",/iPad|iPhone|iPod/.test(navigator.userAgent)),document.querySelectorAll('.hero, .overlay, .banner, .slider, [class*="hero"], [class*="overlay"]').forEach(e=>{const t=getComputedStyle(e);("0"===t.opacity||"hidden"===t.visibility||e.classList.contains("hero"))&&(e.style.pointerEvents="none")});let n=!1;const i=e=>{e?.preventDefault?.(),e?.stopPropagation?.();const i=!("true"===t.getAttribute("aria-expanded"));console.log("Menu toggle triggered, new state:",i),n=i,t.setAttribute("aria-expanded",String(i)),i?(o.classList.remove("hidden"),o.style.display="block",t.querySelector("i").className="fas fa-times text-2xl",t.setAttribute("aria-label","Cerrar menú"),document.body.classList.add("no-scroll"),console.log("Menu opened")):(o.classList.add("hidden"),o.style.display="none",t.querySelector("i").className="fas fa-bars text-2xl",t.setAttribute("aria-label","Abrir menú"),document.body.classList.remove("no-scroll"),console.log("Menu closed"))};t._bound&&t._bound.forEach(e=>t.removeEventListener("pointerup",e)),t._bound=[i],t.addEventListener("pointerup",i),t.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),i(e))}),document.addEventListener("pointerup",function(e){if(!n)return;const r=o.contains(e.target),s=t.contains(e.target);r||s||(i(),console.log("Menu closed (clicked outside)"))});let r;o.querySelectorAll("a").forEach(e=>{e.addEventListener("pointerup",function(){console.log("Menu link clicked, navigating to:",this.href),i()})}),document.addEventListener("keydown",function(e){"Escape"===e.key&&n&&(i(),console.log("Menu closed (ESC key)"))}),window.addEventListener("resize",function(){clearTimeout(r),r=setTimeout(function(){window.innerWidth>=768&&n&&(i(),console.log("Menu closed (window resized to desktop)"))},100)}),t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),t.setAttribute("aria-controls","mobile-menu"),t.setAttribute("aria-label","Abrir menú"),setTimeout(function(){console.log("Post-init verification:"),console.log("Menu toggle clickable?",!t.style.pointerEvents||"none"!==t.style.pointerEvents),console.log("Menu toggle visible?","none"!==window.getComputedStyle(t).display),console.log("Menu toggle z-index:",window.getComputedStyle(t).zIndex),/iPad|iPhone|iPod/.test(navigator.userAgent)&&(t.style.pointerEvents="auto",t.style.zIndex="10001",t.style.position="relative",console.log("iOS critical styles forced on menu toggle")),window.debugMenuPosition&&window.debugMenuPosition()},500),menuInitDone=!0,console.log("Mobile menu initialized successfully (iOS professional version)")}